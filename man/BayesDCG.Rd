% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/BayesDCG.r
\name{BayesDCG}
\alias{BayesDCG}
\title{Bayesian Cyclic Causal Discovery}
\usage{
BayesDCG(
  data_matrix,
  a_mu = 0,
  b_mu = 2,
  a_gamma = 1,
  b_gamma = 20,
  a_tao = 2,
  b_tao = 1,
  a_gamma_1 = 0.5,
  b_gamma_1 = 0.5,
  alpha = 1,
  M,
  num_iter
)
}
\arguments{
\item{data_matrix}{Numeric matrix of dimension \eqn{N \times p}, where rows correspond to observations and columns correspond to variables (features) included in the causal graph.}

\item{a_mu}{Hyperparameter for the mean of the normal prior on each mixture component mean \eqn{\mu_k} in the error mixture model (location parameter). Default value is 0.}

\item{b_mu}{Hyperparameter for the variance of the normal prior on each mixture component mean \eqn{\mu_k} (controls how tightly the component means are shrunk toward \code{a_mu}).
Default value is 2.}

\item{a_gamma}{First shape parameter of the Beta prior on the edge-inclusion probability \eqn{\gamma} (probability that there is an edge from one node to another).
Default value is 1.}

\item{b_gamma}{Second shape parameter of the Beta prior on the edge-inclusion probability \eqn{\gamma}. Along with \code{a_gamma} this controls the expected sparsity of the graph.
Default value is 20.}

\item{a_tao}{Shape parameter of the inverse gamma prior on each mixture component variance in the error distribution (controls the prior tail heaviness for component variances).
Default value is 2.}

\item{b_tao}{Scale parameter of the inverse gamma prior on each mixture component variance in the error distribution (sets the typical size of the component variances).
Default value is 1.}

\item{a_gamma_1}{Shape parameter of the inverse gamma prior on the slab variance \eqn{\gamma_1} in the conditional spike-and-slab prior \eqn{B_{ij}\mid E_{ij},
\gamma_1 \sim (1-E_{ij})\delta_0 + E_{ij}N(0,\gamma_1)}. Default value is 0.5.}

\item{b_gamma_1}{Scale parameter of the inverse gamma prior on \eqn{\gamma_1}. Default value is 0.5.}

\item{alpha}{Concentration parameter of the Dirichlet prior on the mixture weights for the normal mixture error distribution (controls how evenly the mixture components are used).
Default value is 1}

\item{M}{Integer giving the maximum number of mixture components allowed in the normal mixture error model.}

\item{num_iter}{Integer giving the total number of MCMC iterations for the \code{BayesDCG} algorithm.}
}
\value{
A list (from the C backend) typically containing adjacency and causal-effect matrices and samples/diagnostics.
}
\description{
BayesDCG fits a Bayesian linear causal model on a directed cyclic graph (DCG) with non-Gaussian errors, returning posterior samples of the adjacency and causal-effect matrices for systems with feedback.
}
\examples{
# Run BayesDCG based on simulated example

set.seed(21)

# Simulation Settings

N = 250 # Sample size for the test data
num_covariates = 7 # Number of features for test data
M = 2 # Number of finite clusters for mixed normal in likelihood
num_iter = 5000 # Number of iterations MCMC runs


# Generate Synthetic DCG Data

example_list = generates_examples_DCG(num_covariates, N, M, 0.9, 21)

data_matrix = example_list$data_matrix # generated data
Adjacency_matrix_true = example_list$Adjacency_matrix_true # true graph structure

# Hyperparameter Structure

params = list(
 a_mu = 0,
 b_mu = 2,
 a_gamma = 1,
 b_gamma = 20,
 a_gamma_1 = 0.5,
 b_gamma_1 = 0.5,
 a_tao = 2,
 b_tao = 1,
 alpha = 1
)

# Run BayesDCG

result_list = BayesDCG(
 data_matrix,
 params$a_mu,
 params$b_mu,
 params$a_gamma,
 params$b_gamma,
 params$a_tao,
 params$b_tao,
 params$a_gamma_1,
 params$b_gamma_1,
 params$alpha,
 M,
 num_iter
)

# Basic posterior summaries

Adjacency_matrix_list = result_list$Adjacency_matrix_list
Causal_effect_matrix_list = result_list$Causal_effect_matrix_list
gamma_list = result_list$gamma_list
gamma_1_list = result_list$gamma_1_list
mu_matrix_list = result_list$mu_matrix_list
tao_matrix_list = result_list$tao_matrix_list
pi_matrix_list = result_list$pi_matrix_list
log_likelihood_list = result_list$log_likelihood_list

head(log_likelihood_list)
}
